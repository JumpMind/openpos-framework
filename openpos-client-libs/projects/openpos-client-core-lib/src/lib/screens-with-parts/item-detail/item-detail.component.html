<app-bacon-strip></app-bacon-strip>
<section class="item-details">
    <mat-card responsive-class class="padding-none page-gutter">
        <div responsive-class class="item-card padding-none page-gutter page-element margin-bottom">
            <h1 class="name" responsive-class>{{screen.itemName}}</h1>
            <app-carousel class="carousel" [carouselSize]="carouselSize" [carouselItemClass]="'rounded-edge'">
                <ng-template *ngFor="let image of screen.imageUrls" #carouselItem>
                    <app-image [imageUrl]="image | imageUrl" [altImageUrl]="screen.alternateImageUrl" [altText]="'Image NotFound'"></app-image>
                </ng-template>
            </app-carousel>
            
            <div class="inv-cost">
                <app-currency-text class="item-price" [amountText]="screen.price"></app-currency-text>
                <span>{{screen.inventoryMessage}}</span>
            </div>

            <ul responsive-class class="properties">
                <li *ngFor="let prop of screen.itemProperties">
                    <app-display-property [property]="prop" alignmentType="jagged"></app-display-property>
                </li>
            </ul>

            <div class="options">
                <ng-container *ngFor="let component of optionComponents | keyvalue">
                    <ng-container *ngComponentOutlet="component.value; injector: component.key"></ng-container>
                </ng-container>
            </div>
            
            <div class="summary-instructions">
                <hr>                
                <app-instructions class="option-instructions" *ngIf="screen.itemOptionInstructions" [instructions]="screen.itemOptionInstructions"></app-instructions>
                <p class="summary" *ngIf="screen.summary" responsive-class>{{screen.summary}}</p>
            </div>

            <div class="actions">
                <ng-container *ngFor="let button of screen.actions; let first = first;">
                    <app-secondary-button *ngIf="!first" [ngClass]="button.additionalStyle" (buttonClick)="doAction(button)">
                        <app-icon *ngIf="button.icon" [iconName]="button.icon"></app-icon>
                        <span>{{button.title}}</span>
                    </app-secondary-button>
                </ng-container>
                <ng-container *ngFor="let button of screen.actions; let first = first;">
                    <app-primary-button *ngIf="first" [ngClass]="button.additionalStyle" [disabled]="!button.enabled" (buttonClick)="doAction(button)">
                        <app-icon *ngIf="button.icon" [iconName]="button.icon"></app-icon>
                        <span>{{button.title}}</span>
                    </app-primary-button>
                </ng-container>
            </div>
        </div>

    </mat-card>
    
    <div class="inv-prom-container" responsive-class>
        <mat-card responsive-class class="buddy-store page-gutter padding-none">
            <div responsive-class class="page-gutter page-element margin-bottom">
                <h3 responsive-class>
                    {{screen.buddyStoreTitle}} "Buddy Stores"
                </h3>

                <span class="buddy-store-table-header promotion-item-gray">
                    <!-- <div class="promotion-item-icon">
                        <app-icon iconClass="md"></app-icon>
                    </div> -->
                    <div class="promotion-item-name">
                        Store
                    </div>
                    <div class="price">
                        Count
                    </div>
                </span>
                <span *ngFor="let store of screen.buddyStores; let i = index" class="promotion-items" [class.promotion-item-gray]="i % 2">
                    <!-- <div class="promotion-item-icon">
                        <app-icon [iconName]="" color="primary" class="promotion-icon" iconClass="md"></app-icon>
                    </div> -->
                    <div class="promotion-item-name">
                        {{store.storeName}}
                    </div>
                    <div class="price">
                        {{store.storeCount}}
                    </div>
                </span>
            </div>
        </mat-card>
        
        <mat-card responsive-class *ngIf="screen.promotions" class="promotions page-gutter padding-none">
            <div responsive-class class="page-gutter page-element margin-bottom">
                <h3 responsive-class>
                    {{screen.promotions && screen.promotions.length > 0 ? screen.itemPromotionsTitle : screen.itemNoPromotionsTitle}}
                </h3>
                <app-instructions *ngIf="screen.promotions && screen.promotions.length > 1"  [instructions]="screen.promotionStackingDisclaimer"
                                [instructionsSize]="'text-md'"></app-instructions>

                <table class="item-details-table promotions">
                    <thead>
                        <tr>
                            <th><app-icon iconClass="md"></app-icon></th>
                            <th>{{screen.itemValueDisplay.label}}</th>
                            <th>{{screen.itemValueDisplay.value}}</th>
                        </tr>
                    </thead>
                    
                    <tbody>
                        <tr *ngFor="let promo of screen.promotions">
                            <td><app-icon [iconName]="promo.icon" color="primary" class="promotion-icon" iconClass="md"></app-icon></td>
                            <td>{{promo.promotionName}}</td>
                            <td>{{promo.promotionPrice}}</td>
                        </tr>
                    </tbody>
                </table>
                <!-- <span class="promotion-items promotion-item-gray">
                    <div class="promotion-item-icon">
                        <app-icon iconClass="md"></app-icon>
                    </div>
                    <div class="promotion-item-name">
                        {{screen.itemValueDisplay.label}}
                    </div>
                    <div class="price">
                        {{screen.itemValueDisplay.value}}
                    </div>
                </span>
                <span *ngFor="let promo of screen.promotions; let i = index" class="promotion-items" [class.promotion-item-gray]="i % 2">
                    <div class="promotion-item-icon">
                        <app-icon [iconName]="promo.icon" color="primary" class="promotion-icon" iconClass="md"></app-icon>
                    </div>
                    <div class="promotion-item-name">
                        {{promo.promotionName}}
                    </div>
                    <div class="price">
                        {{promo.promotionPrice}}
                    </div>
                </span> -->
            </div>
        </mat-card>
    </div>
</section>

